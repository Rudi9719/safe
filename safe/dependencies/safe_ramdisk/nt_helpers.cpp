/*
  Safe Ramdisk:
  A simple Windows driver to emulate a FAT32 formatted disk drive
  backed by paged memory in the Windows kernel.

  Copyright (C) 2014 Rian Hunter <rian@alum.mit.edu>

  This program is free software: you can redistribute it and/or modify
  it under the terms of the GNU General Public License as published by
  the Free Software Foundation, either version 2 of the License, or
  (at your option) any later version.

  This program is distributed in the hope that it will be useful,
  but WITHOUT ANY WARRANTY; without even the implied warranty of
  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  GNU Lesser General Public License for more details.

  You should have received a copy of the GNU Lesser General Public License
  along with this program.  If not, see <http://www.gnu.org/licenses/>
 */

#include <ntifs.h>

#include <mountdev.h>
#include <ntdddisk.h>
#include <ntddstor.h>
#include <ntddvol.h>

namespace safe_nt {

#ifdef DBG

const char *
ioctl_to_string(ULONG ioctl) {
#define __R(a) case a: return #a
  switch (ioctl) {
    __R(IOCTL_DISK_GET_DRIVE_GEOMETRY);
    __R(IOCTL_DISK_IS_WRITABLE);
    __R(IOCTL_DISK_GET_PARTITION_INFO_EX);
    __R(IOCTL_DISK_GET_LENGTH_INFO);
    __R(IOCTL_DISK_GET_DRIVE_GEOMETRY_EX);
    __R(IOCTL_DISK_CHECK_VERIFY);
    //    __R(IOCTL_DISK_MEDIA_REMOVAL);
    __R(IOCTL_DISK_GET_MEDIA_TYPES);
    __R(IOCTL_STORAGE_QUERY_PROPERTY);
    //    __R(IOCTL_STORAGE_GET_HOTPLUG_INFO);
    __R(IOCTL_STORAGE_GET_DEVICE_NUMBER);
    __R(IOCTL_MOUNTDEV_QUERY_DEVICE_NAME);
    __R(IOCTL_MOUNTDEV_QUERY_UNIQUE_ID);
    __R(IOCTL_VOLUME_GET_VOLUME_DISK_EXTENTS);
    __R(IOCTL_VOLUME_GET_GPT_ATTRIBUTES);
  default: return "unknown!";
  }
#undef __R
}

const char *
pnp_minor_function_to_string(UCHAR minor) {
#define IRP_MN_DEVICE_ENUMERATED 0x19
#define __R(a) case a: return #a
  switch (minor) {
    __R(IRP_MN_START_DEVICE);
    __R(IRP_MN_QUERY_STOP_DEVICE);
    __R(IRP_MN_CANCEL_STOP_DEVICE);
    __R(IRP_MN_STOP_DEVICE);
    __R(IRP_MN_QUERY_REMOVE_DEVICE);
    __R(IRP_MN_CANCEL_REMOVE_DEVICE);
    __R(IRP_MN_SURPRISE_REMOVAL);
    __R(IRP_MN_REMOVE_DEVICE);
    __R(IRP_MN_QUERY_DEVICE_RELATIONS);
    __R(IRP_MN_FILTER_RESOURCE_REQUIREMENTS);
    __R(IRP_MN_DEVICE_ENUMERATED);
    __R(IRP_MN_QUERY_CAPABILITIES);
    __R(IRP_MN_QUERY_PNP_DEVICE_STATE);
    __R(IRP_MN_QUERY_LEGACY_BUS_INFORMATION);
    default: return "unknown";
  }
#undef __R
}

const char *
nt_status_to_string(NTSTATUS status) {
#define __R(a) case a: return #a
  switch (status) {
  __R(STATUS_SUCCESS);
  __R(STATUS_WAIT_1);
  __R(STATUS_WAIT_2);
  __R(STATUS_WAIT_3);
  __R(STATUS_WAIT_63);
  __R(STATUS_ABANDONED);
  __R(STATUS_ABANDONED_WAIT_63);
  __R(STATUS_USER_APC);
  __R(STATUS_KERNEL_APC);
  __R(STATUS_ALERTED);
  __R(STATUS_TIMEOUT);
  __R(STATUS_PENDING);
  __R(STATUS_REPARSE);
  __R(STATUS_MORE_ENTRIES);
  __R(STATUS_NOT_ALL_ASSIGNED);
  __R(STATUS_SOME_NOT_MAPPED);
  __R(STATUS_OPLOCK_BREAK_IN_PROGRESS);
  __R(STATUS_VOLUME_MOUNTED);
  __R(STATUS_RXACT_COMMITTED);
  __R(STATUS_NOTIFY_CLEANUP);
  __R(STATUS_NOTIFY_ENUM_DIR);
  __R(STATUS_NO_QUOTAS_FOR_ACCOUNT);
  __R(STATUS_PRIMARY_TRANSPORT_CONNECT_FAILED);
  __R(STATUS_PAGE_FAULT_TRANSITION);
  __R(STATUS_PAGE_FAULT_DEMAND_ZERO);
  __R(STATUS_PAGE_FAULT_COPY_ON_WRITE);
  __R(STATUS_PAGE_FAULT_GUARD_PAGE);
  __R(STATUS_PAGE_FAULT_PAGING_FILE);
  __R(STATUS_CACHE_PAGE_LOCKED);
  __R(STATUS_CRASH_DUMP);
  __R(STATUS_BUFFER_ALL_ZEROS);
  __R(STATUS_REPARSE_OBJECT);
  __R(STATUS_RESOURCE_REQUIREMENTS_CHANGED);
  __R(STATUS_TRANSLATION_COMPLETE);
  __R(STATUS_DS_MEMBERSHIP_EVALUATED_LOCALLY);
  __R(STATUS_NOTHING_TO_TERMINATE);
  __R(STATUS_PROCESS_NOT_IN_JOB);
  __R(STATUS_PROCESS_IN_JOB);
  __R(STATUS_OBJECT_NAME_EXISTS);
  __R(STATUS_THREAD_WAS_SUSPENDED);
  __R(STATUS_WORKING_SET_LIMIT_RANGE);
  __R(STATUS_IMAGE_NOT_AT_BASE);
  __R(STATUS_RXACT_STATE_CREATED);
  __R(STATUS_SEGMENT_NOTIFICATION);
  __R(STATUS_LOCAL_USER_SESSION_KEY);
  __R(STATUS_BAD_CURRENT_DIRECTORY);
  __R(STATUS_SERIAL_MORE_WRITES);
  __R(STATUS_REGISTRY_RECOVERED);
  __R(STATUS_FT_READ_RECOVERY_FROM_BACKUP);
  __R(STATUS_FT_WRITE_RECOVERY);
  __R(STATUS_SERIAL_COUNTER_TIMEOUT);
  __R(STATUS_NULL_LM_PASSWORD);
  __R(STATUS_IMAGE_MACHINE_TYPE_MISMATCH);
  __R(STATUS_RECEIVE_PARTIAL);
  __R(STATUS_RECEIVE_EXPEDITED);
  __R(STATUS_RECEIVE_PARTIAL_EXPEDITED);
  __R(STATUS_EVENT_DONE);
  __R(STATUS_EVENT_PENDING);
  __R(STATUS_CHECKING_FILE_SYSTEM);
  __R(STATUS_FATAL_APP_EXIT);
  __R(STATUS_PREDEFINED_HANDLE);
  __R(STATUS_WAS_UNLOCKED);
  __R(STATUS_SERVICE_NOTIFICATION);
  __R(STATUS_WAS_LOCKED);
  __R(STATUS_LOG_HARD_ERROR);
  __R(STATUS_ALREADY_WIN32);
  __R(STATUS_WX86_UNSIMULATE);
  __R(STATUS_WX86_CONTINUE);
  __R(STATUS_WX86_SINGLE_STEP);
  __R(STATUS_WX86_BREAKPOINT);
  __R(STATUS_WX86_EXCEPTION_CONTINUE);
  __R(STATUS_WX86_EXCEPTION_LASTCHANCE);
  __R(STATUS_WX86_EXCEPTION_CHAIN);
  __R(STATUS_IMAGE_MACHINE_TYPE_MISMATCH_EXE);
  __R(STATUS_NO_YIELD_PERFORMED);
  __R(STATUS_TIMER_RESUME_IGNORED);
  __R(STATUS_ARBITRATION_UNHANDLED);
  __R(STATUS_CARDBUS_NOT_SUPPORTED);
  __R(STATUS_WX86_CREATEWX86TIB);
  __R(STATUS_MP_PROCESSOR_MISMATCH);
  __R(STATUS_HIBERNATED);
  __R(STATUS_RESUME_HIBERNATION);
  __R(STATUS_GUARD_PAGE_VIOLATION);
  __R(STATUS_DATATYPE_MISALIGNMENT);
  __R(STATUS_BREAKPOINT);
  __R(STATUS_SINGLE_STEP);
  __R(STATUS_BUFFER_OVERFLOW);
  __R(STATUS_NO_MORE_FILES);
  __R(STATUS_WAKE_SYSTEM_DEBUGGER);
  __R(STATUS_HANDLES_CLOSED);
  __R(STATUS_NO_INHERITANCE);
  __R(STATUS_GUID_SUBSTITUTION_MADE);
  __R(STATUS_PARTIAL_COPY);
  __R(STATUS_DEVICE_PAPER_EMPTY);
  __R(STATUS_DEVICE_POWERED_OFF);
  __R(STATUS_DEVICE_OFF_LINE);
  __R(STATUS_DEVICE_BUSY);
  __R(STATUS_NO_MORE_EAS);
  __R(STATUS_INVALID_EA_NAME);
  __R(STATUS_EA_LIST_INCONSISTENT);
  __R(STATUS_INVALID_EA_FLAG);
  __R(STATUS_VERIFY_REQUIRED);
  __R(STATUS_EXTRANEOUS_INFORMATION);
  __R(STATUS_RXACT_COMMIT_NECESSARY);
  __R(STATUS_NO_MORE_ENTRIES);
  __R(STATUS_FILEMARK_DETECTED);
  __R(STATUS_MEDIA_CHANGED);
  __R(STATUS_BUS_RESET);
  __R(STATUS_END_OF_MEDIA);
  __R(STATUS_BEGINNING_OF_MEDIA);
  __R(STATUS_MEDIA_CHECK);
  __R(STATUS_SETMARK_DETECTED);
  __R(STATUS_NO_DATA_DETECTED);
  __R(STATUS_REDIRECTOR_HAS_OPEN_HANDLES);
  __R(STATUS_SERVER_HAS_OPEN_HANDLES);
  __R(STATUS_ALREADY_DISCONNECTED);
  __R(STATUS_LONGJUMP);
  __R(STATUS_CLEANER_CARTRIDGE_INSTALLED);
  __R(STATUS_PLUGPLAY_QUERY_VETOED);
  __R(STATUS_UNWIND_CONSOLIDATE);
  __R(STATUS_CLUSTER_NODE_ALREADY_UP);
  __R(STATUS_CLUSTER_NODE_ALREADY_DOWN);
  __R(STATUS_CLUSTER_NETWORK_ALREADY_ONLINE);
  __R(STATUS_CLUSTER_NETWORK_ALREADY_OFFLINE);
  __R(STATUS_CLUSTER_NODE_ALREADY_MEMBER);
  __R(STATUS_UNSUCCESSFUL);
  __R(STATUS_NOT_IMPLEMENTED);
  __R(STATUS_INVALID_INFO_CLASS);
  __R(STATUS_INFO_LENGTH_MISMATCH);
  __R(STATUS_ACCESS_VIOLATION);
  __R(STATUS_IN_PAGE_ERROR);
  __R(STATUS_PAGEFILE_QUOTA);
  __R(STATUS_INVALID_HANDLE);
  __R(STATUS_BAD_INITIAL_STACK);
  __R(STATUS_BAD_INITIAL_PC);
  __R(STATUS_INVALID_CID);
  __R(STATUS_TIMER_NOT_CANCELED);
  __R(STATUS_INVALID_PARAMETER);
  __R(STATUS_NO_SUCH_DEVICE);
  __R(STATUS_NO_SUCH_FILE);
  __R(STATUS_INVALID_DEVICE_REQUEST);
  __R(STATUS_END_OF_FILE);
  __R(STATUS_WRONG_VOLUME);
  __R(STATUS_NO_MEDIA_IN_DEVICE);
  __R(STATUS_UNRECOGNIZED_MEDIA);
  __R(STATUS_NONEXISTENT_SECTOR);
  __R(STATUS_MORE_PROCESSING_REQUIRED);
  __R(STATUS_NO_MEMORY);
  __R(STATUS_CONFLICTING_ADDRESSES);
  __R(STATUS_NOT_MAPPED_VIEW);
  __R(STATUS_UNABLE_TO_FREE_VM);
  __R(STATUS_UNABLE_TO_DELETE_SECTION);
  __R(STATUS_INVALID_SYSTEM_SERVICE);
  __R(STATUS_ILLEGAL_INSTRUCTION);
  __R(STATUS_INVALID_LOCK_SEQUENCE);
  __R(STATUS_INVALID_VIEW_SIZE);
  __R(STATUS_INVALID_FILE_FOR_SECTION);
  __R(STATUS_ALREADY_COMMITTED);
  __R(STATUS_ACCESS_DENIED);
  __R(STATUS_BUFFER_TOO_SMALL);
  __R(STATUS_OBJECT_TYPE_MISMATCH);
  __R(STATUS_NONCONTINUABLE_EXCEPTION);
  __R(STATUS_INVALID_DISPOSITION);
  __R(STATUS_UNWIND);
  __R(STATUS_BAD_STACK);
  __R(STATUS_INVALID_UNWIND_TARGET);
  __R(STATUS_NOT_LOCKED);
  __R(STATUS_PARITY_ERROR);
  __R(STATUS_UNABLE_TO_DECOMMIT_VM);
  __R(STATUS_NOT_COMMITTED);
  __R(STATUS_INVALID_PORT_ATTRIBUTES);
  __R(STATUS_PORT_MESSAGE_TOO_LONG);
  __R(STATUS_INVALID_PARAMETER_MIX);
  __R(STATUS_INVALID_QUOTA_LOWER);
  __R(STATUS_DISK_CORRUPT_ERROR);
  __R(STATUS_OBJECT_NAME_INVALID);
  __R(STATUS_OBJECT_NAME_NOT_FOUND);
  __R(STATUS_OBJECT_NAME_COLLISION);
  __R(STATUS_PORT_DISCONNECTED);
  __R(STATUS_DEVICE_ALREADY_ATTACHED);
  __R(STATUS_OBJECT_PATH_INVALID);
  __R(STATUS_OBJECT_PATH_NOT_FOUND);
  __R(STATUS_OBJECT_PATH_SYNTAX_BAD);
  __R(STATUS_DATA_OVERRUN);
  __R(STATUS_DATA_LATE_ERROR);
  __R(STATUS_DATA_ERROR);
  __R(STATUS_CRC_ERROR);
  __R(STATUS_SECTION_TOO_BIG);
  __R(STATUS_PORT_CONNECTION_REFUSED);
  __R(STATUS_INVALID_PORT_HANDLE);
  __R(STATUS_SHARING_VIOLATION);
  __R(STATUS_QUOTA_EXCEEDED);
  __R(STATUS_INVALID_PAGE_PROTECTION);
  __R(STATUS_MUTANT_NOT_OWNED);
  __R(STATUS_SEMAPHORE_LIMIT_EXCEEDED);
  __R(STATUS_PORT_ALREADY_SET);
  __R(STATUS_SECTION_NOT_IMAGE);
  __R(STATUS_SUSPEND_COUNT_EXCEEDED);
  __R(STATUS_THREAD_IS_TERMINATING);
  __R(STATUS_BAD_WORKING_SET_LIMIT);
  __R(STATUS_INCOMPATIBLE_FILE_MAP);
  __R(STATUS_SECTION_PROTECTION);
  __R(STATUS_EAS_NOT_SUPPORTED);
  __R(STATUS_EA_TOO_LARGE);
  __R(STATUS_NONEXISTENT_EA_ENTRY);
  __R(STATUS_NO_EAS_ON_FILE);
  __R(STATUS_EA_CORRUPT_ERROR);
  __R(STATUS_FILE_LOCK_CONFLICT);
  __R(STATUS_LOCK_NOT_GRANTED);
  __R(STATUS_DELETE_PENDING);
  __R(STATUS_CTL_FILE_NOT_SUPPORTED);
  __R(STATUS_UNKNOWN_REVISION);
  __R(STATUS_REVISION_MISMATCH);
  __R(STATUS_INVALID_OWNER);
  __R(STATUS_INVALID_PRIMARY_GROUP);
  __R(STATUS_NO_IMPERSONATION_TOKEN);
  __R(STATUS_CANT_DISABLE_MANDATORY);
  __R(STATUS_NO_LOGON_SERVERS);
  __R(STATUS_NO_SUCH_LOGON_SESSION);
  __R(STATUS_NO_SUCH_PRIVILEGE);
  __R(STATUS_PRIVILEGE_NOT_HELD);
  __R(STATUS_INVALID_ACCOUNT_NAME);
  __R(STATUS_USER_EXISTS);
  __R(STATUS_NO_SUCH_USER);
  __R(STATUS_GROUP_EXISTS);
  __R(STATUS_NO_SUCH_GROUP);
  __R(STATUS_MEMBER_IN_GROUP);
  __R(STATUS_MEMBER_NOT_IN_GROUP);
  __R(STATUS_LAST_ADMIN);
  __R(STATUS_WRONG_PASSWORD);
  __R(STATUS_ILL_FORMED_PASSWORD);
  __R(STATUS_PASSWORD_RESTRICTION);
  __R(STATUS_LOGON_FAILURE);
  __R(STATUS_ACCOUNT_RESTRICTION);
  __R(STATUS_INVALID_LOGON_HOURS);
  __R(STATUS_INVALID_WORKSTATION);
  __R(STATUS_PASSWORD_EXPIRED);
  __R(STATUS_ACCOUNT_DISABLED);
  __R(STATUS_NONE_MAPPED);
  __R(STATUS_TOO_MANY_LUIDS_REQUESTED);
  __R(STATUS_LUIDS_EXHAUSTED);
  __R(STATUS_INVALID_SUB_AUTHORITY);
  __R(STATUS_INVALID_ACL);
  __R(STATUS_INVALID_SID);
  __R(STATUS_INVALID_SECURITY_DESCR);
  __R(STATUS_PROCEDURE_NOT_FOUND);
  __R(STATUS_INVALID_IMAGE_FORMAT);
  __R(STATUS_NO_TOKEN);
  __R(STATUS_BAD_INHERITANCE_ACL);
  __R(STATUS_RANGE_NOT_LOCKED);
  __R(STATUS_DISK_FULL);
  __R(STATUS_SERVER_DISABLED);
  __R(STATUS_SERVER_NOT_DISABLED);
  __R(STATUS_TOO_MANY_GUIDS_REQUESTED);
  __R(STATUS_GUIDS_EXHAUSTED);
  __R(STATUS_INVALID_ID_AUTHORITY);
  __R(STATUS_AGENTS_EXHAUSTED);
  __R(STATUS_INVALID_VOLUME_LABEL);
  __R(STATUS_SECTION_NOT_EXTENDED);
  __R(STATUS_NOT_MAPPED_DATA);
  __R(STATUS_RESOURCE_DATA_NOT_FOUND);
  __R(STATUS_RESOURCE_TYPE_NOT_FOUND);
  __R(STATUS_RESOURCE_NAME_NOT_FOUND);
  __R(STATUS_ARRAY_BOUNDS_EXCEEDED);
  __R(STATUS_FLOAT_DENORMAL_OPERAND);
  __R(STATUS_FLOAT_DIVIDE_BY_ZERO);
  __R(STATUS_FLOAT_INEXACT_RESULT);
  __R(STATUS_FLOAT_INVALID_OPERATION);
  __R(STATUS_FLOAT_OVERFLOW);
  __R(STATUS_FLOAT_STACK_CHECK);
  __R(STATUS_FLOAT_UNDERFLOW);
  __R(STATUS_INTEGER_DIVIDE_BY_ZERO);
  __R(STATUS_INTEGER_OVERFLOW);
  __R(STATUS_PRIVILEGED_INSTRUCTION);
  __R(STATUS_TOO_MANY_PAGING_FILES);
  __R(STATUS_FILE_INVALID);
  __R(STATUS_ALLOTTED_SPACE_EXCEEDED);
  __R(STATUS_INSUFFICIENT_RESOURCES);
  __R(STATUS_DFS_EXIT_PATH_FOUND);
  __R(STATUS_DEVICE_DATA_ERROR);
  __R(STATUS_DEVICE_NOT_CONNECTED);
  __R(STATUS_DEVICE_POWER_FAILURE);
  __R(STATUS_FREE_VM_NOT_AT_BASE);
  __R(STATUS_MEMORY_NOT_ALLOCATED);
  __R(STATUS_WORKING_SET_QUOTA);
  __R(STATUS_MEDIA_WRITE_PROTECTED);
  __R(STATUS_DEVICE_NOT_READY);
  __R(STATUS_INVALID_GROUP_ATTRIBUTES);
  __R(STATUS_BAD_IMPERSONATION_LEVEL);
  __R(STATUS_CANT_OPEN_ANONYMOUS);
  __R(STATUS_BAD_VALIDATION_CLASS);
  __R(STATUS_BAD_TOKEN_TYPE);
  __R(STATUS_BAD_MASTER_BOOT_RECORD);
  __R(STATUS_INSTRUCTION_MISALIGNMENT);
  __R(STATUS_INSTANCE_NOT_AVAILABLE);
  __R(STATUS_PIPE_NOT_AVAILABLE);
  __R(STATUS_INVALID_PIPE_STATE);
  __R(STATUS_PIPE_BUSY);
  __R(STATUS_ILLEGAL_FUNCTION);
  __R(STATUS_PIPE_DISCONNECTED);
  __R(STATUS_PIPE_CLOSING);
  __R(STATUS_PIPE_CONNECTED);
  __R(STATUS_PIPE_LISTENING);
  __R(STATUS_INVALID_READ_MODE);
  __R(STATUS_IO_TIMEOUT);
  __R(STATUS_FILE_FORCED_CLOSED);
  __R(STATUS_PROFILING_NOT_STARTED);
  __R(STATUS_PROFILING_NOT_STOPPED);
  __R(STATUS_COULD_NOT_INTERPRET);
  __R(STATUS_FILE_IS_A_DIRECTORY);
  __R(STATUS_NOT_SUPPORTED);
  __R(STATUS_REMOTE_NOT_LISTENING);
  __R(STATUS_DUPLICATE_NAME);
  __R(STATUS_BAD_NETWORK_PATH);
  __R(STATUS_NETWORK_BUSY);
  __R(STATUS_DEVICE_DOES_NOT_EXIST);
  __R(STATUS_TOO_MANY_COMMANDS);
  __R(STATUS_ADAPTER_HARDWARE_ERROR);
  __R(STATUS_INVALID_NETWORK_RESPONSE);
  __R(STATUS_UNEXPECTED_NETWORK_ERROR);
  __R(STATUS_BAD_REMOTE_ADAPTER);
  __R(STATUS_PRINT_QUEUE_FULL);
  __R(STATUS_NO_SPOOL_SPACE);
  __R(STATUS_PRINT_CANCELLED);
  __R(STATUS_NETWORK_NAME_DELETED);
  __R(STATUS_NETWORK_ACCESS_DENIED);
  __R(STATUS_BAD_DEVICE_TYPE);
  __R(STATUS_BAD_NETWORK_NAME);
  __R(STATUS_TOO_MANY_NAMES);
  __R(STATUS_TOO_MANY_SESSIONS);
  __R(STATUS_SHARING_PAUSED);
  __R(STATUS_REQUEST_NOT_ACCEPTED);
  __R(STATUS_REDIRECTOR_PAUSED);
  __R(STATUS_NET_WRITE_FAULT);
  __R(STATUS_PROFILING_AT_LIMIT);
  __R(STATUS_NOT_SAME_DEVICE);
  __R(STATUS_FILE_RENAMED);
  __R(STATUS_VIRTUAL_CIRCUIT_CLOSED);
  __R(STATUS_NO_SECURITY_ON_OBJECT);
  __R(STATUS_CANT_WAIT);
  __R(STATUS_PIPE_EMPTY);
  __R(STATUS_CANT_ACCESS_DOMAIN_INFO);
  __R(STATUS_CANT_TERMINATE_SELF);
  __R(STATUS_INVALID_SERVER_STATE);
  __R(STATUS_INVALID_DOMAIN_STATE);
  __R(STATUS_INVALID_DOMAIN_ROLE);
  __R(STATUS_NO_SUCH_DOMAIN);
  __R(STATUS_DOMAIN_EXISTS);
  __R(STATUS_DOMAIN_LIMIT_EXCEEDED);
  __R(STATUS_OPLOCK_NOT_GRANTED);
  __R(STATUS_INVALID_OPLOCK_PROTOCOL);
  __R(STATUS_INTERNAL_DB_CORRUPTION);
  __R(STATUS_INTERNAL_ERROR);
  __R(STATUS_GENERIC_NOT_MAPPED);
  __R(STATUS_BAD_DESCRIPTOR_FORMAT);
  __R(STATUS_INVALID_USER_BUFFER);
  __R(STATUS_UNEXPECTED_IO_ERROR);
  __R(STATUS_UNEXPECTED_MM_CREATE_ERR);
  __R(STATUS_UNEXPECTED_MM_MAP_ERROR);
  __R(STATUS_UNEXPECTED_MM_EXTEND_ERR);
  __R(STATUS_NOT_LOGON_PROCESS);
  __R(STATUS_LOGON_SESSION_EXISTS);
  __R(STATUS_INVALID_PARAMETER_1);
  __R(STATUS_INVALID_PARAMETER_2);
  __R(STATUS_INVALID_PARAMETER_3);
  __R(STATUS_INVALID_PARAMETER_4);
  __R(STATUS_INVALID_PARAMETER_5);
  __R(STATUS_INVALID_PARAMETER_6);
  __R(STATUS_INVALID_PARAMETER_7);
  __R(STATUS_INVALID_PARAMETER_8);
  __R(STATUS_INVALID_PARAMETER_9);
  __R(STATUS_INVALID_PARAMETER_10);
  __R(STATUS_INVALID_PARAMETER_11);
  __R(STATUS_INVALID_PARAMETER_12);
  __R(STATUS_REDIRECTOR_NOT_STARTED);
  __R(STATUS_REDIRECTOR_STARTED);
  __R(STATUS_STACK_OVERFLOW);
  __R(STATUS_NO_SUCH_PACKAGE);
  __R(STATUS_BAD_FUNCTION_TABLE);
  __R(STATUS_VARIABLE_NOT_FOUND);
  __R(STATUS_DIRECTORY_NOT_EMPTY);
  __R(STATUS_FILE_CORRUPT_ERROR);
  __R(STATUS_NOT_A_DIRECTORY);
  __R(STATUS_BAD_LOGON_SESSION_STATE);
  __R(STATUS_LOGON_SESSION_COLLISION);
  __R(STATUS_NAME_TOO_LONG);
  __R(STATUS_FILES_OPEN);
  __R(STATUS_CONNECTION_IN_USE);
  __R(STATUS_MESSAGE_NOT_FOUND);
  __R(STATUS_PROCESS_IS_TERMINATING);
  __R(STATUS_INVALID_LOGON_TYPE);
  __R(STATUS_NO_GUID_TRANSLATION);
  __R(STATUS_CANNOT_IMPERSONATE);
  __R(STATUS_IMAGE_ALREADY_LOADED);
  __R(STATUS_ABIOS_NOT_PRESENT);
  __R(STATUS_ABIOS_LID_NOT_EXIST);
  __R(STATUS_ABIOS_LID_ALREADY_OWNED);
  __R(STATUS_ABIOS_NOT_LID_OWNER);
  __R(STATUS_ABIOS_INVALID_COMMAND);
  __R(STATUS_ABIOS_INVALID_LID);
  __R(STATUS_ABIOS_SELECTOR_NOT_AVAILABLE);
  __R(STATUS_ABIOS_INVALID_SELECTOR);
  __R(STATUS_NO_LDT);
  __R(STATUS_INVALID_LDT_SIZE);
  __R(STATUS_INVALID_LDT_OFFSET);
  __R(STATUS_INVALID_LDT_DESCRIPTOR);
  __R(STATUS_INVALID_IMAGE_NE_FORMAT);
  __R(STATUS_RXACT_INVALID_STATE);
  __R(STATUS_RXACT_COMMIT_FAILURE);
  __R(STATUS_MAPPED_FILE_SIZE_ZERO);
  __R(STATUS_TOO_MANY_OPENED_FILES);
  __R(STATUS_CANCELLED);
  __R(STATUS_CANNOT_DELETE);
  __R(STATUS_INVALID_COMPUTER_NAME);
  __R(STATUS_FILE_DELETED);
  __R(STATUS_SPECIAL_ACCOUNT);
  __R(STATUS_SPECIAL_GROUP);
  __R(STATUS_SPECIAL_USER);
  __R(STATUS_MEMBERS_PRIMARY_GROUP);
  __R(STATUS_FILE_CLOSED);
  __R(STATUS_TOO_MANY_THREADS);
  __R(STATUS_THREAD_NOT_IN_PROCESS);
  __R(STATUS_TOKEN_ALREADY_IN_USE);
  __R(STATUS_PAGEFILE_QUOTA_EXCEEDED);
  __R(STATUS_COMMITMENT_LIMIT);
  __R(STATUS_INVALID_IMAGE_LE_FORMAT);
  __R(STATUS_INVALID_IMAGE_NOT_MZ);
  __R(STATUS_INVALID_IMAGE_PROTECT);
  __R(STATUS_INVALID_IMAGE_WIN_16);
  __R(STATUS_LOGON_SERVER_CONFLICT);
  __R(STATUS_TIME_DIFFERENCE_AT_DC);
  __R(STATUS_SYNCHRONIZATION_REQUIRED);
  __R(STATUS_DLL_NOT_FOUND);
  __R(STATUS_OPEN_FAILED);
  __R(STATUS_IO_PRIVILEGE_FAILED);
  __R(STATUS_ORDINAL_NOT_FOUND);
  __R(STATUS_ENTRYPOINT_NOT_FOUND);
  __R(STATUS_CONTROL_C_EXIT);
  __R(STATUS_LOCAL_DISCONNECT);
  __R(STATUS_REMOTE_DISCONNECT);
  __R(STATUS_REMOTE_RESOURCES);
  __R(STATUS_LINK_FAILED);
  __R(STATUS_LINK_TIMEOUT);
  __R(STATUS_INVALID_CONNECTION);
  __R(STATUS_INVALID_ADDRESS);
  __R(STATUS_DLL_INIT_FAILED);
  __R(STATUS_MISSING_SYSTEMFILE);
  __R(STATUS_UNHANDLED_EXCEPTION);
  __R(STATUS_APP_INIT_FAILURE);
  __R(STATUS_PAGEFILE_CREATE_FAILED);
  __R(STATUS_NO_PAGEFILE);
  __R(STATUS_INVALID_LEVEL);
  __R(STATUS_WRONG_PASSWORD_CORE);
  __R(STATUS_ILLEGAL_FLOAT_CONTEXT);
  __R(STATUS_PIPE_BROKEN);
  __R(STATUS_REGISTRY_CORRUPT);
  __R(STATUS_REGISTRY_IO_FAILED);
  __R(STATUS_NO_EVENT_PAIR);
  __R(STATUS_UNRECOGNIZED_VOLUME);
  __R(STATUS_SERIAL_NO_DEVICE_INITED);
  __R(STATUS_NO_SUCH_ALIAS);
  __R(STATUS_MEMBER_NOT_IN_ALIAS);
  __R(STATUS_MEMBER_IN_ALIAS);
  __R(STATUS_ALIAS_EXISTS);
  __R(STATUS_LOGON_NOT_GRANTED);
  __R(STATUS_TOO_MANY_SECRETS);
  __R(STATUS_SECRET_TOO_LONG);
  __R(STATUS_INTERNAL_DB_ERROR);
  __R(STATUS_FULLSCREEN_MODE);
  __R(STATUS_TOO_MANY_CONTEXT_IDS);
  __R(STATUS_LOGON_TYPE_NOT_GRANTED);
  __R(STATUS_NOT_REGISTRY_FILE);
  __R(STATUS_NT_CROSS_ENCRYPTION_REQUIRED);
  __R(STATUS_DOMAIN_CTRLR_CONFIG_ERROR);
  __R(STATUS_FT_MISSING_MEMBER);
  __R(STATUS_ILL_FORMED_SERVICE_ENTRY);
  __R(STATUS_ILLEGAL_CHARACTER);
  __R(STATUS_UNMAPPABLE_CHARACTER);
  __R(STATUS_UNDEFINED_CHARACTER);
  __R(STATUS_FLOPPY_VOLUME);
  __R(STATUS_FLOPPY_ID_MARK_NOT_FOUND);
  __R(STATUS_FLOPPY_WRONG_CYLINDER);
  __R(STATUS_FLOPPY_UNKNOWN_ERROR);
  __R(STATUS_FLOPPY_BAD_REGISTERS);
  __R(STATUS_DISK_RECALIBRATE_FAILED);
  __R(STATUS_DISK_OPERATION_FAILED);
  __R(STATUS_DISK_RESET_FAILED);
  __R(STATUS_SHARED_IRQ_BUSY);
  __R(STATUS_FT_ORPHANING);
  __R(STATUS_BIOS_FAILED_TO_CONNECT_INTERRUPT);
  __R(STATUS_PARTITION_FAILURE);
  __R(STATUS_INVALID_BLOCK_LENGTH);
  __R(STATUS_DEVICE_NOT_PARTITIONED);
  __R(STATUS_UNABLE_TO_LOCK_MEDIA);
  __R(STATUS_UNABLE_TO_UNLOAD_MEDIA);
  __R(STATUS_EOM_OVERFLOW);
  __R(STATUS_NO_MEDIA);
  __R(STATUS_NO_SUCH_MEMBER);
  __R(STATUS_INVALID_MEMBER);
  __R(STATUS_KEY_DELETED);
  __R(STATUS_NO_LOG_SPACE);
  __R(STATUS_TOO_MANY_SIDS);
  __R(STATUS_LM_CROSS_ENCRYPTION_REQUIRED);
  __R(STATUS_KEY_HAS_CHILDREN);
  __R(STATUS_CHILD_MUST_BE_VOLATILE);
  __R(STATUS_DEVICE_CONFIGURATION_ERROR);
  __R(STATUS_DRIVER_INTERNAL_ERROR);
  __R(STATUS_INVALID_DEVICE_STATE);
  __R(STATUS_IO_DEVICE_ERROR);
  __R(STATUS_DEVICE_PROTOCOL_ERROR);
  __R(STATUS_BACKUP_CONTROLLER);
  __R(STATUS_LOG_FILE_FULL);
  __R(STATUS_TOO_LATE);
  __R(STATUS_NO_TRUST_LSA_SECRET);
  __R(STATUS_NO_TRUST_SAM_ACCOUNT);
  __R(STATUS_TRUSTED_DOMAIN_FAILURE);
  __R(STATUS_TRUSTED_RELATIONSHIP_FAILURE);
  __R(STATUS_EVENTLOG_FILE_CORRUPT);
  __R(STATUS_EVENTLOG_CANT_START);
  __R(STATUS_TRUST_FAILURE);
  __R(STATUS_MUTANT_LIMIT_EXCEEDED);
  __R(STATUS_NETLOGON_NOT_STARTED);
  __R(STATUS_ACCOUNT_EXPIRED);
  __R(STATUS_POSSIBLE_DEADLOCK);
  __R(STATUS_NETWORK_CREDENTIAL_CONFLICT);
  __R(STATUS_REMOTE_SESSION_LIMIT);
  __R(STATUS_EVENTLOG_FILE_CHANGED);
  __R(STATUS_NOLOGON_INTERDOMAIN_TRUST_ACCOUNT);
  __R(STATUS_NOLOGON_WORKSTATION_TRUST_ACCOUNT);
  __R(STATUS_NOLOGON_SERVER_TRUST_ACCOUNT);
  __R(STATUS_DOMAIN_TRUST_INCONSISTENT);
  __R(STATUS_FS_DRIVER_REQUIRED);
  __R(STATUS_NO_USER_SESSION_KEY);
  __R(STATUS_USER_SESSION_DELETED);
  __R(STATUS_RESOURCE_LANG_NOT_FOUND);
  __R(STATUS_INSUFF_SERVER_RESOURCES);
  __R(STATUS_INVALID_BUFFER_SIZE);
  __R(STATUS_INVALID_ADDRESS_COMPONENT);
  __R(STATUS_INVALID_ADDRESS_WILDCARD);
  __R(STATUS_TOO_MANY_ADDRESSES);
  __R(STATUS_ADDRESS_ALREADY_EXISTS);
  __R(STATUS_ADDRESS_CLOSED);
  __R(STATUS_CONNECTION_DISCONNECTED);
  __R(STATUS_CONNECTION_RESET);
  __R(STATUS_TOO_MANY_NODES);
  __R(STATUS_TRANSACTION_ABORTED);
  __R(STATUS_TRANSACTION_TIMED_OUT);
  __R(STATUS_TRANSACTION_NO_RELEASE);
  __R(STATUS_TRANSACTION_NO_MATCH);
  __R(STATUS_TRANSACTION_RESPONDED);
  __R(STATUS_TRANSACTION_INVALID_ID);
  __R(STATUS_TRANSACTION_INVALID_TYPE);
  __R(STATUS_NOT_SERVER_SESSION);
  __R(STATUS_NOT_CLIENT_SESSION);
  __R(STATUS_CANNOT_LOAD_REGISTRY_FILE);
  __R(STATUS_DEBUG_ATTACH_FAILED);
  __R(STATUS_SYSTEM_PROCESS_TERMINATED);
  __R(STATUS_DATA_NOT_ACCEPTED);
  __R(STATUS_NO_BROWSER_SERVERS_FOUND);
  __R(STATUS_VDM_HARD_ERROR);
  __R(STATUS_DRIVER_CANCEL_TIMEOUT);
  __R(STATUS_REPLY_MESSAGE_MISMATCH);
  __R(STATUS_MAPPED_ALIGNMENT);
  __R(STATUS_IMAGE_CHECKSUM_MISMATCH);
  __R(STATUS_LOST_WRITEBEHIND_DATA);
  __R(STATUS_CLIENT_SERVER_PARAMETERS_INVALID);
  __R(STATUS_PASSWORD_MUST_CHANGE);
  __R(STATUS_NOT_FOUND);
  __R(STATUS_NOT_TINY_STREAM);
  __R(STATUS_RECOVERY_FAILURE);
  __R(STATUS_STACK_OVERFLOW_READ);
  __R(STATUS_FAIL_CHECK);
  __R(STATUS_DUPLICATE_OBJECTID);
  __R(STATUS_OBJECTID_EXISTS);
  __R(STATUS_CONVERT_TO_LARGE);
  __R(STATUS_RETRY);
  __R(STATUS_FOUND_OUT_OF_SCOPE);
  __R(STATUS_ALLOCATE_BUCKET);
  __R(STATUS_PROPSET_NOT_FOUND);
  __R(STATUS_MARSHALL_OVERFLOW);
  __R(STATUS_INVALID_VARIANT);
  __R(STATUS_DOMAIN_CONTROLLER_NOT_FOUND);
  __R(STATUS_ACCOUNT_LOCKED_OUT);
  __R(STATUS_HANDLE_NOT_CLOSABLE);
  __R(STATUS_CONNECTION_REFUSED);
  __R(STATUS_GRACEFUL_DISCONNECT);
  __R(STATUS_ADDRESS_ALREADY_ASSOCIATED);
  __R(STATUS_ADDRESS_NOT_ASSOCIATED);
  __R(STATUS_CONNECTION_INVALID);
  __R(STATUS_CONNECTION_ACTIVE);
  __R(STATUS_NETWORK_UNREACHABLE);
  __R(STATUS_HOST_UNREACHABLE);
  __R(STATUS_PROTOCOL_UNREACHABLE);
  __R(STATUS_PORT_UNREACHABLE);
  __R(STATUS_REQUEST_ABORTED);
  __R(STATUS_CONNECTION_ABORTED);
  __R(STATUS_BAD_COMPRESSION_BUFFER);
  __R(STATUS_USER_MAPPED_FILE);
  __R(STATUS_AUDIT_FAILED);
  __R(STATUS_TIMER_RESOLUTION_NOT_SET);
  __R(STATUS_CONNECTION_COUNT_LIMIT);
  __R(STATUS_LOGIN_TIME_RESTRICTION);
  __R(STATUS_LOGIN_WKSTA_RESTRICTION);
  __R(STATUS_IMAGE_MP_UP_MISMATCH);
  __R(STATUS_INSUFFICIENT_LOGON_INFO);
  __R(STATUS_BAD_DLL_ENTRYPOINT);
  __R(STATUS_BAD_SERVICE_ENTRYPOINT);
  __R(STATUS_LPC_REPLY_LOST);
  __R(STATUS_IP_ADDRESS_CONFLICT1);
  __R(STATUS_IP_ADDRESS_CONFLICT2);
  __R(STATUS_REGISTRY_QUOTA_LIMIT);
  __R(STATUS_PATH_NOT_COVERED);
  __R(STATUS_NO_CALLBACK_ACTIVE);
  __R(STATUS_LICENSE_QUOTA_EXCEEDED);
  __R(STATUS_PWD_TOO_SHORT);
  __R(STATUS_PWD_TOO_RECENT);
  __R(STATUS_PWD_HISTORY_CONFLICT);
  __R(STATUS_PLUGPLAY_NO_DEVICE);
  __R(STATUS_UNSUPPORTED_COMPRESSION);
  __R(STATUS_INVALID_HW_PROFILE);
  __R(STATUS_INVALID_PLUGPLAY_DEVICE_PATH);
  __R(STATUS_DRIVER_ORDINAL_NOT_FOUND);
  __R(STATUS_DRIVER_ENTRYPOINT_NOT_FOUND);
  __R(STATUS_RESOURCE_NOT_OWNED);
  __R(STATUS_TOO_MANY_LINKS);
  __R(STATUS_QUOTA_LIST_INCONSISTENT);
  __R(STATUS_FILE_IS_OFFLINE);
  __R(STATUS_EVALUATION_EXPIRATION);
  __R(STATUS_ILLEGAL_DLL_RELOCATION);
  __R(STATUS_LICENSE_VIOLATION);
  __R(STATUS_DLL_INIT_FAILED_LOGOFF);
  __R(STATUS_DRIVER_UNABLE_TO_LOAD);
  __R(STATUS_DFS_UNAVAILABLE);
  __R(STATUS_VOLUME_DISMOUNTED);
  __R(STATUS_WX86_INTERNAL_ERROR);
  __R(STATUS_WX86_FLOAT_STACK_CHECK);
  __R(STATUS_VALIDATE_CONTINUE);
  __R(STATUS_NO_MATCH);
  __R(STATUS_NO_MORE_MATCHES);
  __R(STATUS_NOT_A_REPARSE_POINT);
  __R(STATUS_IO_REPARSE_TAG_INVALID);
  __R(STATUS_IO_REPARSE_TAG_MISMATCH);
  __R(STATUS_IO_REPARSE_DATA_INVALID);
  __R(STATUS_IO_REPARSE_TAG_NOT_HANDLED);
  __R(STATUS_REPARSE_POINT_NOT_RESOLVED);
  __R(STATUS_DIRECTORY_IS_A_REPARSE_POINT);
  __R(STATUS_RANGE_LIST_CONFLICT);
  __R(STATUS_SOURCE_ELEMENT_EMPTY);
  __R(STATUS_DESTINATION_ELEMENT_FULL);
  __R(STATUS_ILLEGAL_ELEMENT_ADDRESS);
  __R(STATUS_MAGAZINE_NOT_PRESENT);
  __R(STATUS_REINITIALIZATION_NEEDED);
  __R(STATUS_DEVICE_REQUIRES_CLEANING);
  __R(STATUS_DEVICE_DOOR_OPEN);
  __R(STATUS_ENCRYPTION_FAILED);
  __R(STATUS_DECRYPTION_FAILED);
  __R(STATUS_RANGE_NOT_FOUND);
  __R(STATUS_NO_RECOVERY_POLICY);
  __R(STATUS_NO_EFS);
  __R(STATUS_WRONG_EFS);
  __R(STATUS_NO_USER_KEYS);
  __R(STATUS_FILE_NOT_ENCRYPTED);
  __R(STATUS_NOT_EXPORT_FORMAT);
  __R(STATUS_FILE_ENCRYPTED);
  __R(STATUS_WAKE_SYSTEM);
  __R(STATUS_WMI_GUID_NOT_FOUND);
  __R(STATUS_WMI_INSTANCE_NOT_FOUND);
  __R(STATUS_WMI_ITEMID_NOT_FOUND);
  __R(STATUS_WMI_TRY_AGAIN);
  __R(STATUS_SHARED_POLICY);
  __R(STATUS_POLICY_OBJECT_NOT_FOUND);
  __R(STATUS_POLICY_ONLY_IN_DS);
  __R(STATUS_VOLUME_NOT_UPGRADED);
  __R(STATUS_REMOTE_STORAGE_NOT_ACTIVE);
  __R(STATUS_REMOTE_STORAGE_MEDIA_ERROR);
  __R(STATUS_NO_TRACKING_SERVICE);
  __R(STATUS_SERVER_SID_MISMATCH);
  __R(STATUS_DS_NO_ATTRIBUTE_OR_VALUE);
  __R(STATUS_DS_INVALID_ATTRIBUTE_SYNTAX);
  __R(STATUS_DS_ATTRIBUTE_TYPE_UNDEFINED);
  __R(STATUS_DS_ATTRIBUTE_OR_VALUE_EXISTS);
  __R(STATUS_DS_BUSY);
  __R(STATUS_DS_UNAVAILABLE);
  __R(STATUS_DS_NO_RIDS_ALLOCATED);
  __R(STATUS_DS_NO_MORE_RIDS);
  __R(STATUS_DS_INCORRECT_ROLE_OWNER);
  __R(STATUS_DS_RIDMGR_INIT_ERROR);
  __R(STATUS_DS_OBJ_CLASS_VIOLATION);
  __R(STATUS_DS_CANT_ON_NON_LEAF);
  __R(STATUS_DS_CANT_ON_RDN);
  __R(STATUS_DS_CANT_MOD_OBJ_CLASS);
  __R(STATUS_DS_CROSS_DOM_MOVE_FAILED);
  __R(STATUS_DS_GC_NOT_AVAILABLE);
  __R(STATUS_DIRECTORY_SERVICE_REQUIRED);
  __R(STATUS_REPARSE_ATTRIBUTE_CONFLICT);
  __R(STATUS_CANT_ENABLE_DENY_ONLY);
  __R(STATUS_FLOAT_MULTIPLE_FAULTS);
  __R(STATUS_FLOAT_MULTIPLE_TRAPS);
  __R(STATUS_DEVICE_REMOVED);
  __R(STATUS_JOURNAL_DELETE_IN_PROGRESS);
  __R(STATUS_JOURNAL_NOT_ACTIVE);
  __R(STATUS_NOINTERFACE);
  __R(STATUS_DS_ADMIN_LIMIT_EXCEEDED);
  __R(STATUS_DRIVER_FAILED_SLEEP);
  __R(STATUS_MUTUAL_AUTHENTICATION_FAILED);
  __R(STATUS_CORRUPT_SYSTEM_FILE);
  __R(STATUS_DATATYPE_MISALIGNMENT_ERROR);
  __R(STATUS_WMI_READ_ONLY);
  __R(STATUS_WMI_SET_FAILURE);
  __R(STATUS_COMMITMENT_MINIMUM);
  __R(STATUS_REG_NAT_CONSUMPTION);
  __R(STATUS_TRANSPORT_FULL);
  __R(STATUS_DS_SAM_INIT_FAILURE);
  __R(STATUS_ONLY_IF_CONNECTED);
  __R(STATUS_DS_SENSITIVE_GROUP_VIOLATION);
  __R(STATUS_PNP_RESTART_ENUMERATION);
  __R(STATUS_JOURNAL_ENTRY_DELETED);
  __R(STATUS_DS_CANT_MOD_PRIMARYGROUPID);
  __R(STATUS_SYSTEM_IMAGE_BAD_SIGNATURE);
  __R(STATUS_PNP_REBOOT_REQUIRED);
  __R(STATUS_POWER_STATE_INVALID);
  __R(STATUS_DS_INVALID_GROUP_TYPE);
  __R(STATUS_DS_NO_NEST_GLOBALGROUP_IN_MIXEDDOMAIN);
  __R(STATUS_DS_NO_NEST_LOCALGROUP_IN_MIXEDDOMAIN);
  __R(STATUS_DS_GLOBAL_CANT_HAVE_LOCAL_MEMBER);
  __R(STATUS_DS_GLOBAL_CANT_HAVE_UNIVERSAL_MEMBER);
  __R(STATUS_DS_UNIVERSAL_CANT_HAVE_LOCAL_MEMBER);
  __R(STATUS_DS_GLOBAL_CANT_HAVE_CROSSDOMAIN_MEMBER);
  __R(STATUS_DS_LOCAL_CANT_HAVE_CROSSDOMAIN_LOCAL_MEMBER);
  __R(STATUS_DS_HAVE_PRIMARY_MEMBERS);
  __R(STATUS_WMI_NOT_SUPPORTED);
  __R(STATUS_INSUFFICIENT_POWER);
  __R(STATUS_SAM_NEED_BOOTKEY_PASSWORD);
  __R(STATUS_SAM_NEED_BOOTKEY_FLOPPY);
  __R(STATUS_DS_CANT_START);
  __R(STATUS_DS_INIT_FAILURE);
  __R(STATUS_SAM_INIT_FAILURE);
  __R(STATUS_DS_GC_REQUIRED);
  __R(STATUS_DS_LOCAL_MEMBER_OF_LOCAL_ONLY);
  __R(STATUS_DS_NO_FPO_IN_UNIVERSAL_GROUPS);
  __R(STATUS_DS_MACHINE_ACCOUNT_QUOTA_EXCEEDED);
  __R(STATUS_MULTIPLE_FAULT_VIOLATION);
  __R(STATUS_CURRENT_DOMAIN_NOT_ALLOWED);
  __R(STATUS_CANNOT_MAKE);
  __R(STATUS_SYSTEM_SHUTDOWN);
  __R(STATUS_DS_INIT_FAILURE_CONSOLE);
  __R(STATUS_DS_SAM_INIT_FAILURE_CONSOLE);
  __R(STATUS_UNFINISHED_CONTEXT_DELETED);
  __R(STATUS_NO_TGT_REPLY);
  __R(STATUS_OBJECTID_NOT_FOUND);
  __R(STATUS_NO_IP_ADDRESSES);
  __R(STATUS_WRONG_CREDENTIAL_HANDLE);
  __R(STATUS_CRYPTO_SYSTEM_INVALID);
  __R(STATUS_MAX_REFERRALS_EXCEEDED);
  __R(STATUS_MUST_BE_KDC);
  __R(STATUS_STRONG_CRYPTO_NOT_SUPPORTED);
  __R(STATUS_TOO_MANY_PRINCIPALS);
  __R(STATUS_NO_PA_DATA);
  __R(STATUS_PKINIT_NAME_MISMATCH);
  __R(STATUS_SMARTCARD_LOGON_REQUIRED);
  __R(STATUS_KDC_INVALID_REQUEST);
  __R(STATUS_KDC_UNABLE_TO_REFER);
  __R(STATUS_KDC_UNKNOWN_ETYPE);
  __R(STATUS_SHUTDOWN_IN_PROGRESS);
  __R(STATUS_SERVER_SHUTDOWN_IN_PROGRESS);
  __R(STATUS_NOT_SUPPORTED_ON_SBS);
  __R(STATUS_WMI_GUID_DISCONNECTED);
  __R(STATUS_WMI_ALREADY_DISABLED);
  __R(STATUS_WMI_ALREADY_ENABLED);
  __R(STATUS_MFT_TOO_FRAGMENTED);
  __R(STATUS_COPY_PROTECTION_FAILURE);
  __R(STATUS_CSS_AUTHENTICATION_FAILURE);
  __R(STATUS_CSS_KEY_NOT_PRESENT);
  __R(STATUS_CSS_KEY_NOT_ESTABLISHED);
  __R(STATUS_CSS_SCRAMBLED_SECTOR);
  __R(STATUS_CSS_REGION_MISMATCH);
  __R(STATUS_CSS_RESETS_EXHAUSTED);
  __R(STATUS_PKINIT_FAILURE);
  __R(STATUS_SMARTCARD_SUBSYSTEM_FAILURE);
  __R(STATUS_NO_KERB_KEY);
  __R(STATUS_HOST_DOWN);
  __R(STATUS_UNSUPPORTED_PREAUTH);
  __R(STATUS_EFS_ALG_BLOB_TOO_BIG);
  __R(STATUS_PORT_NOT_SET);
  __R(STATUS_DEBUGGER_INACTIVE);
  __R(STATUS_DS_VERSION_CHECK_FAILURE);
  __R(STATUS_AUDITING_DISABLED);
  __R(STATUS_PRENT4_MACHINE_ACCOUNT);
  __R(STATUS_DS_AG_CANT_HAVE_UNIVERSAL_MEMBER);
  __R(STATUS_INVALID_IMAGE_WIN_32);
  __R(STATUS_INVALID_IMAGE_WIN_64);
  __R(STATUS_BAD_BINDINGS);
  __R(STATUS_NETWORK_SESSION_EXPIRED);
  __R(STATUS_APPHELP_BLOCK);
  __R(STATUS_ALL_SIDS_FILTERED);
  __R(STATUS_NOT_SAFE_MODE_DRIVER);
  __R(STATUS_ACCESS_DISABLED_BY_POLICY_DEFAULT);
  __R(STATUS_ACCESS_DISABLED_BY_POLICY_PATH);
  __R(STATUS_ACCESS_DISABLED_BY_POLICY_PUBLISHER);
  __R(STATUS_ACCESS_DISABLED_BY_POLICY_OTHER);
  __R(STATUS_FAILED_DRIVER_ENTRY);
  __R(STATUS_DEVICE_ENUMERATION_ERROR);
  __R(STATUS_WAIT_FOR_OPLOCK);
  __R(STATUS_MOUNT_POINT_NOT_RESOLVED);
  __R(STATUS_INVALID_DEVICE_OBJECT_PARAMETER);
  __R(STATUS_MCA_OCCURED);
  __R(STATUS_DRIVER_BLOCKED_CRITICAL);
  __R(STATUS_DRIVER_BLOCKED);
  __R(STATUS_DRIVER_DATABASE_ERROR);
  __R(STATUS_SYSTEM_HIVE_TOO_LARGE);
  __R(STATUS_INVALID_IMPORT_OF_NON_DLL);
  __R(STATUS_DS_SHUTTING_DOWN);
  __R(STATUS_SMARTCARD_WRONG_PIN);
  __R(STATUS_SMARTCARD_CARD_BLOCKED);
  __R(STATUS_SMARTCARD_CARD_NOT_AUTHENTICATED);
  __R(STATUS_SMARTCARD_NO_CARD);
  __R(STATUS_SMARTCARD_NO_KEY_CONTAINER);
  __R(STATUS_SMARTCARD_NO_CERTIFICATE);
  __R(STATUS_SMARTCARD_NO_KEYSET);
  __R(STATUS_SMARTCARD_IO_ERROR);
  __R(STATUS_DOWNGRADE_DETECTED);
  __R(STATUS_SMARTCARD_CERT_REVOKED);
  __R(STATUS_ISSUING_CA_UNTRUSTED);
  __R(STATUS_REVOCATION_OFFLINE_C);
  __R(STATUS_PKINIT_CLIENT_FAILURE);
  __R(STATUS_SMARTCARD_CERT_EXPIRED);
  __R(STATUS_DRIVER_FAILED_PRIOR_UNLOAD);
  __R(STATUS_WOW_ASSERTION);
  __R(RPC_NT_INVALID_STRING_BINDING);
  __R(RPC_NT_WRONG_KIND_OF_BINDING);
  __R(RPC_NT_INVALID_BINDING);
  __R(RPC_NT_PROTSEQ_NOT_SUPPORTED);
  __R(RPC_NT_INVALID_RPC_PROTSEQ);
  __R(RPC_NT_INVALID_STRING_UUID);
  __R(RPC_NT_INVALID_ENDPOINT_FORMAT);
  __R(RPC_NT_INVALID_NET_ADDR);
  __R(RPC_NT_NO_ENDPOINT_FOUND);
  __R(RPC_NT_INVALID_TIMEOUT);
  __R(RPC_NT_OBJECT_NOT_FOUND);
  __R(RPC_NT_ALREADY_REGISTERED);
  __R(RPC_NT_TYPE_ALREADY_REGISTERED);
  __R(RPC_NT_ALREADY_LISTENING);
  __R(RPC_NT_NO_PROTSEQS_REGISTERED);
  __R(RPC_NT_NOT_LISTENING);
  __R(RPC_NT_UNKNOWN_MGR_TYPE);
  __R(RPC_NT_UNKNOWN_IF);
  __R(RPC_NT_NO_BINDINGS);
  __R(RPC_NT_NO_PROTSEQS);
  __R(RPC_NT_CANT_CREATE_ENDPOINT);
  __R(RPC_NT_OUT_OF_RESOURCES);
  __R(RPC_NT_SERVER_UNAVAILABLE);
  __R(RPC_NT_SERVER_TOO_BUSY);
  __R(RPC_NT_INVALID_NETWORK_OPTIONS);
  __R(RPC_NT_NO_CALL_ACTIVE);
  __R(RPC_NT_CALL_FAILED);
  __R(RPC_NT_CALL_FAILED_DNE);
  __R(RPC_NT_PROTOCOL_ERROR);
  __R(RPC_NT_UNSUPPORTED_TRANS_SYN);
  __R(RPC_NT_UNSUPPORTED_TYPE);
  __R(RPC_NT_INVALID_TAG);
  __R(RPC_NT_INVALID_BOUND);
  __R(RPC_NT_NO_ENTRY_NAME);
  __R(RPC_NT_INVALID_NAME_SYNTAX);
  __R(RPC_NT_UNSUPPORTED_NAME_SYNTAX);
  __R(RPC_NT_UUID_NO_ADDRESS);
  __R(RPC_NT_DUPLICATE_ENDPOINT);
  __R(RPC_NT_UNKNOWN_AUTHN_TYPE);
  __R(RPC_NT_MAX_CALLS_TOO_SMALL);
  __R(RPC_NT_STRING_TOO_LONG);
  __R(RPC_NT_PROTSEQ_NOT_FOUND);
  __R(RPC_NT_PROCNUM_OUT_OF_RANGE);
  __R(RPC_NT_BINDING_HAS_NO_AUTH);
  __R(RPC_NT_UNKNOWN_AUTHN_SERVICE);
  __R(RPC_NT_UNKNOWN_AUTHN_LEVEL);
  __R(RPC_NT_INVALID_AUTH_IDENTITY);
  __R(RPC_NT_UNKNOWN_AUTHZ_SERVICE);
  __R(EPT_NT_INVALID_ENTRY);
  __R(EPT_NT_CANT_PERFORM_OP);
  __R(EPT_NT_NOT_REGISTERED);
  __R(RPC_NT_NOTHING_TO_EXPORT);
  __R(RPC_NT_INCOMPLETE_NAME);
  __R(RPC_NT_INVALID_VERS_OPTION);
  __R(RPC_NT_NO_MORE_MEMBERS);
  __R(RPC_NT_NOT_ALL_OBJS_UNEXPORTED);
  __R(RPC_NT_INTERFACE_NOT_FOUND);
  __R(RPC_NT_ENTRY_ALREADY_EXISTS);
  __R(RPC_NT_ENTRY_NOT_FOUND);
  __R(RPC_NT_NAME_SERVICE_UNAVAILABLE);
  __R(RPC_NT_INVALID_NAF_ID);
  __R(RPC_NT_CANNOT_SUPPORT);
  __R(RPC_NT_NO_CONTEXT_AVAILABLE);
  __R(RPC_NT_INTERNAL_ERROR);
  __R(RPC_NT_ZERO_DIVIDE);
  __R(RPC_NT_ADDRESS_ERROR);
  __R(RPC_NT_FP_DIV_ZERO);
  __R(RPC_NT_FP_UNDERFLOW);
  __R(RPC_NT_FP_OVERFLOW);
  __R(RPC_NT_NO_MORE_ENTRIES);
  __R(RPC_NT_SS_CHAR_TRANS_OPEN_FAIL);
  __R(RPC_NT_SS_CHAR_TRANS_SHORT_FILE);
  __R(RPC_NT_SS_IN_NULL_CONTEXT);
  __R(RPC_NT_SS_CONTEXT_MISMATCH);
  __R(RPC_NT_SS_CONTEXT_DAMAGED);
  __R(RPC_NT_SS_HANDLES_MISMATCH);
  __R(RPC_NT_SS_CANNOT_GET_CALL_HANDLE);
  __R(RPC_NT_NULL_REF_POINTER);
  __R(RPC_NT_ENUM_VALUE_OUT_OF_RANGE);
  __R(RPC_NT_BYTE_COUNT_TOO_SMALL);
  __R(RPC_NT_BAD_STUB_DATA);
  __R(RPC_NT_CALL_IN_PROGRESS);
  __R(RPC_NT_NO_MORE_BINDINGS);
  __R(RPC_NT_GROUP_MEMBER_NOT_FOUND);
  __R(EPT_NT_CANT_CREATE);
  __R(RPC_NT_INVALID_OBJECT);
  __R(RPC_NT_NO_INTERFACES);
  __R(RPC_NT_CALL_CANCELLED);
  __R(RPC_NT_BINDING_INCOMPLETE);
  __R(RPC_NT_COMM_FAILURE);
  __R(RPC_NT_UNSUPPORTED_AUTHN_LEVEL);
  __R(RPC_NT_NO_PRINC_NAME);
  __R(RPC_NT_NOT_RPC_ERROR);
  __R(RPC_NT_UUID_LOCAL_ONLY);
  __R(RPC_NT_SEC_PKG_ERROR);
  __R(RPC_NT_NOT_CANCELLED);
  __R(RPC_NT_INVALID_ES_ACTION);
  __R(RPC_NT_WRONG_ES_VERSION);
  __R(RPC_NT_WRONG_STUB_VERSION);
  __R(RPC_NT_INVALID_PIPE_OBJECT);
  __R(RPC_NT_INVALID_PIPE_OPERATION);
  __R(RPC_NT_WRONG_PIPE_VERSION);
  __R(RPC_NT_PIPE_CLOSED);
  __R(RPC_NT_PIPE_DISCIPLINE_ERROR);
  __R(RPC_NT_PIPE_EMPTY);
  __R(RPC_NT_INVALID_ASYNC_HANDLE);
  __R(RPC_NT_INVALID_ASYNC_CALL);
  __R(RPC_NT_SEND_INCOMPLETE);
  __R(STATUS_ACPI_INVALID_OPCODE);
  __R(STATUS_ACPI_STACK_OVERFLOW);
  __R(STATUS_ACPI_ASSERT_FAILED);
  __R(STATUS_ACPI_INVALID_INDEX);
  __R(STATUS_ACPI_INVALID_ARGUMENT);
  __R(STATUS_ACPI_FATAL);
  __R(STATUS_ACPI_INVALID_SUPERNAME);
  __R(STATUS_ACPI_INVALID_ARGTYPE);
  __R(STATUS_ACPI_INVALID_OBJTYPE);
  __R(STATUS_ACPI_INVALID_TARGETTYPE);
  __R(STATUS_ACPI_INCORRECT_ARGUMENT_COUNT);
  __R(STATUS_ACPI_ADDRESS_NOT_MAPPED);
  __R(STATUS_ACPI_INVALID_EVENTTYPE);
  __R(STATUS_ACPI_HANDLER_COLLISION);
  __R(STATUS_ACPI_INVALID_DATA);
  __R(STATUS_ACPI_INVALID_REGION);
  __R(STATUS_ACPI_INVALID_ACCESS_SIZE);
  __R(STATUS_ACPI_ACQUIRE_GLOBAL_LOCK);
  __R(STATUS_ACPI_ALREADY_INITIALIZED);
  __R(STATUS_ACPI_NOT_INITIALIZED);
  __R(STATUS_ACPI_INVALID_MUTEX_LEVEL);
  __R(STATUS_ACPI_MUTEX_NOT_OWNED);
  __R(STATUS_ACPI_MUTEX_NOT_OWNER);
  __R(STATUS_ACPI_RS_ACCESS);
  __R(STATUS_ACPI_INVALID_TABLE);
  __R(STATUS_ACPI_REG_HANDLER_FAILED);
  __R(STATUS_ACPI_POWER_REQUEST_FAILED);
  __R(STATUS_CTX_WINSTATION_NAME_INVALID);
  __R(STATUS_CTX_INVALID_PD);
  __R(STATUS_CTX_PD_NOT_FOUND);
  __R(STATUS_CTX_CDM_CONNECT);
  __R(STATUS_CTX_CDM_DISCONNECT);
  __R(STATUS_CTX_CLOSE_PENDING);
  __R(STATUS_CTX_NO_OUTBUF);
  __R(STATUS_CTX_MODEM_INF_NOT_FOUND);
  __R(STATUS_CTX_INVALID_MODEMNAME);
  __R(STATUS_CTX_RESPONSE_ERROR);
  __R(STATUS_CTX_MODEM_RESPONSE_TIMEOUT);
  __R(STATUS_CTX_MODEM_RESPONSE_NO_CARRIER);
  __R(STATUS_CTX_MODEM_RESPONSE_NO_DIALTONE);
  __R(STATUS_CTX_MODEM_RESPONSE_BUSY);
  __R(STATUS_CTX_MODEM_RESPONSE_VOICE);
  __R(STATUS_CTX_TD_ERROR);
  __R(STATUS_CTX_LICENSE_CLIENT_INVALID);
  __R(STATUS_CTX_LICENSE_NOT_AVAILABLE);
  __R(STATUS_CTX_LICENSE_EXPIRED);
  __R(STATUS_CTX_WINSTATION_NOT_FOUND);
  __R(STATUS_CTX_WINSTATION_NAME_COLLISION);
  __R(STATUS_CTX_WINSTATION_BUSY);
  __R(STATUS_CTX_BAD_VIDEO_MODE);
  __R(STATUS_CTX_GRAPHICS_INVALID);
  __R(STATUS_CTX_NOT_CONSOLE);
  __R(STATUS_CTX_CLIENT_QUERY_TIMEOUT);
  __R(STATUS_CTX_CONSOLE_DISCONNECT);
  __R(STATUS_CTX_CONSOLE_CONNECT);
  __R(STATUS_CTX_SHADOW_DENIED);
  __R(STATUS_CTX_WINSTATION_ACCESS_DENIED);
  __R(STATUS_CTX_INVALID_WD);
  __R(STATUS_CTX_WD_NOT_FOUND);
  __R(STATUS_CTX_SHADOW_INVALID);
  __R(STATUS_CTX_SHADOW_DISABLED);
  __R(STATUS_RDP_PROTOCOL_ERROR);
  __R(STATUS_CTX_CLIENT_LICENSE_NOT_SET);
  __R(STATUS_CTX_CLIENT_LICENSE_IN_USE);
  __R(STATUS_CTX_SHADOW_ENDED_BY_MODE_CHANGE);
  __R(STATUS_CTX_SHADOW_NOT_RUNNING);
  __R(STATUS_PNP_BAD_MPS_TABLE);
  __R(STATUS_PNP_TRANSLATION_FAILED);
  __R(STATUS_PNP_IRQ_TRANSLATION_FAILED);
  __R(STATUS_SXS_SECTION_NOT_FOUND);
  __R(STATUS_SXS_CANT_GEN_ACTCTX);
  __R(STATUS_SXS_INVALID_ACTCTXDATA_FORMAT);
  __R(STATUS_SXS_ASSEMBLY_NOT_FOUND);
  __R(STATUS_SXS_MANIFEST_FORMAT_ERROR);
  __R(STATUS_SXS_MANIFEST_PARSE_ERROR);
  __R(STATUS_SXS_ACTIVATION_CONTEXT_DISABLED);
  __R(STATUS_SXS_KEY_NOT_FOUND);
  __R(STATUS_SXS_VERSION_CONFLICT);
  __R(STATUS_SXS_WRONG_SECTION_TYPE);
  __R(STATUS_SXS_THREAD_QUERIES_DISABLED);
  __R(STATUS_SXS_ASSEMBLY_MISSING);
  __R(STATUS_SXS_RELEASE_ACTIVATION_CONTEXT);
  __R(STATUS_SXS_PROCESS_DEFAULT_ALREADY_SET);
  __R(STATUS_SXS_EARLY_DEACTIVATION);
  __R(STATUS_SXS_INVALID_DEACTIVATION);
  __R(STATUS_SXS_MULTIPLE_DEACTIVATION);
  __R(STATUS_SXS_SYSTEM_DEFAULT_ACTIVATION_CONTEXT_EMPTY);
  __R(STATUS_SXS_PROCESS_TERMINATION_REQUESTED);
  __R(STATUS_CLUSTER_INVALID_NODE);
  __R(STATUS_CLUSTER_NODE_EXISTS);
  __R(STATUS_CLUSTER_JOIN_IN_PROGRESS);
  __R(STATUS_CLUSTER_NODE_NOT_FOUND);
  __R(STATUS_CLUSTER_LOCAL_NODE_NOT_FOUND);
  __R(STATUS_CLUSTER_NETWORK_EXISTS);
  __R(STATUS_CLUSTER_NETWORK_NOT_FOUND);
  __R(STATUS_CLUSTER_NETINTERFACE_EXISTS);
  __R(STATUS_CLUSTER_NETINTERFACE_NOT_FOUND);
  __R(STATUS_CLUSTER_INVALID_REQUEST);
  __R(STATUS_CLUSTER_INVALID_NETWORK_PROVIDER);
  __R(STATUS_CLUSTER_NODE_DOWN);
  __R(STATUS_CLUSTER_NODE_UNREACHABLE);
  __R(STATUS_CLUSTER_NODE_NOT_MEMBER);
  __R(STATUS_CLUSTER_JOIN_NOT_IN_PROGRESS);
  __R(STATUS_CLUSTER_INVALID_NETWORK);
  __R(STATUS_CLUSTER_NO_NET_ADAPTERS);
  __R(STATUS_CLUSTER_NODE_UP);
  __R(STATUS_CLUSTER_NODE_PAUSED);
  __R(STATUS_CLUSTER_NODE_NOT_PAUSED);
  __R(STATUS_CLUSTER_NO_SECURITY_CONTEXT);
  __R(STATUS_CLUSTER_NETWORK_NOT_INTERNAL);
  __R(STATUS_CLUSTER_POISONED);
  default: return "unknown";
  }
#undef __R
}

#else

const char *const NOT_IN_DBG_MODE = "<not in dbg mode>";

const char *
ioctl_to_string(ULONG) {
  return NOT_IN_DBG_MODE;
}

const char *
pnp_minor_function_to_string(UCHAR) {
  return NOT_IN_DBG_MODE;
}

const char *
nt_status_to_string(NTSTATUS) {
  return NOT_IN_DBG_MODE;
}

#endif

NTSTATUS
standard_complete_irp_info(PIRP irp, NTSTATUS status, ULONG_PTR info) noexcept {
  irp->IoStatus.Status = status;
  irp->IoStatus.Information = info;
  IoCompleteRequest(irp, IO_NO_INCREMENT);
  return status;
}

NTSTATUS
standard_complete_irp(PIRP irp, NTSTATUS status) noexcept {
  return standard_complete_irp_info(irp, status, 0);
}

NTSTATUS
check_parameter_size(PIO_STACK_LOCATION io_stack, size_t s) {
  return (io_stack->Parameters.DeviceIoControl.OutputBufferLength < s) ?
    STATUS_BUFFER_TOO_SMALL :
    STATUS_SUCCESS;
}

}
